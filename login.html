<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Login / Registratie</title>

  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 500px;
      margin: 2rem auto;
      padding: 0 15px;
      background: #f2f2f2;
    }
    h1 {
      text-align: center;
    }
    form {
      background: white;
      padding: 1.5rem;
      border-radius: 8px;
      margin-bottom: 1.5rem;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    input {
      width: 100%;
      padding: .7rem;
      margin-bottom: 1rem;
      border-radius: 5px;
      border: 1px solid #bbb;
    }
    button {
      padding: .7rem 1.2rem;
      border: none;
      background: #007bff;
      color: white;
      border-radius: 5px;
      cursor: pointer;
    }
    button:hover {
      background: #0056b3;
    }
    #user-info {
      display: none;
      background: #dff0d8;
      padding: 1rem;
      border-radius: 8px;
      text-align: center;
    }
  </style>
</head>
<body>

    <header>
                <!--navigatie-->
                <ul class="nav">
                        <li><a href="index.html">main parts</a></li>
                        <li><a href="kappen.html">kappen </a></li>
                        <li><a href="stuur.html">stuur</a></li>
                        <li><a href="onderhoud.html">onderhoud</a></li>
                        <li><a href="kleine-details.html">kleine details</a></li>
                        <li><a href="fun.html">fun</a></li>
                        <li><a href="contact.html">contact</a></li>
                </ul>
        </header>


  <h1>Account Login</h1>

  <!-- REGISTRATIE -->
  <form id="signup-form">
    <h2>Account maken</h2>
    <input type="text" id="signup-name" placeholder="Gebruikersnaam" required>
    <input type="email" id="signup-email" placeholder="Email" required>
    <input type="password" id="signup-pass" placeholder="Wachtwoord (min. 6 tekens)" required minlength="6">
    <button type="submit">Registreren</button>
  </form>

  <!-- INLOGGEN -->
  <form id="login-form">
    <h2>Inloggen</h2>
    <input type="email" id="login-email" placeholder="Email" required>
    <input type="password" id="login-pass" placeholder="Wachtwoord" required>
    <button type="submit">Inloggen</button>
  </form>

  <!-- INGELOGDE GEBRUIKER -->
  <div id="user-info">
    <h3 id="welcome"></h3>
    <button id="logout-btn" style="background:#d9534f;">Uitloggen</button>
  </div>

  <!-- FIREBASE -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
    import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut, onAuthStateChanged, updateProfile } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";
    import { getFirestore, doc, setDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

    // â— VERPLICHT: vul jouw echte Firebase-config in
    const firebaseConfig = {
      apiKey: "AIzaSyAh2nx8hk3VTqRIpIWvAOUYfEb_mIEb0-s",
      authDomain: "beta-site-21f67.firebaseapp.com",
      projectId: "beta-site-21f67",
      storageBucket: "beta-site-21f67.firebasestorage.app",
      messagingSenderId: "316488809458",
      appId: "1:316488809458:web:b3c4540c7542e50871c96b"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    const signupForm = document.getElementById("signup-form");
    const loginForm = document.getElementById("login-form");
    const userInfo = document.getElementById("user-info");
    const welcome = document.getElementById("welcome");
    const logoutBtn = document.getElementById("logout-btn");

    // Registreren
    signupForm.addEventListener("submit", async (e) => {
      e.preventDefault();
      const name = document.getElementById("signup-name").value;
      const email = document.getElementById("signup-email").value;
      const pass = document.getElementById("signup-pass").value;

      try {
        const cred = await createUserWithEmailAndPassword(auth, email, pass);
        await updateProfile(cred.user, { displayName: name });

        await setDoc(doc(db, "users", cred.user.uid), {
          uid: cred.user.uid,
          name: name,
          email: email,
          createdAt: serverTimestamp()
        });

        alert("Account aangemaakt!");
        signupForm.reset();
      } catch (err) {
        alert(err.message);
      }
    });

    // Inloggen
    loginForm.addEventListener("submit", async (e) => {
      e.preventDefault();
      const email = document.getElementById("login-email").value;
      const pass = document.getElementById("login-pass").value;

      try {
        await signInWithEmailAndPassword(auth, email, pass);
        loginForm.reset();
      } catch (err) {
        alert("Fout bij inloggen: " + err.message);
      }
    });

    // Uitloggen
    logoutBtn.addEventListener("click", () => signOut(auth));

    // Gebruikersstatus opvolgen
    onAuthStateChanged(auth, (user) => {
      if (user) {
        userInfo.style.display = "block";
        welcome.textContent = `Welkom, ${user.displayName || user.email}`;
      } else {
        userInfo.style.display = "none";
      }
    });
  </script>

</body>
</html>
